# üìñ HISTORIAS DE USUARIO E HISTORIAS T√âCNICAS

## üìå INFORMACI√ìN GENERAL

**Sistema:** Sistema de Gesti√≥n de Env√≠os con B√∫squeda Sem√°ntica  
**Versi√≥n del Documento:** 1.0  
**Fecha:** 2024  
**Alcance:** MVP (Minimum Viable Product)

---

## ‚úÖ DEFINICI√ìN DE "DONE"

Una historia se considera **completa (Done)** cuando cumple con todos los siguientes criterios:

1. **C√≥digo implementado:** El c√≥digo est√° escrito, revisado y cumple con los est√°ndares de calidad establecidos.
2. **Pruebas realizadas:** Se han ejecutado pruebas unitarias y de integraci√≥n, y todas pasan exitosamente.
3. **Criterios de aceptaci√≥n cumplidos:** Todos los criterios de aceptaci√≥n de la historia han sido validados.
4. **Documentaci√≥n actualizada:** La documentaci√≥n t√©cnica y de usuario ha sido actualizada si es necesario.
5. **Revisi√≥n de c√≥digo:** El c√≥digo ha sido revisado por al menos otro desarrollador.
6. **Sin errores cr√≠ticos:** No existen errores cr√≠ticos o bloqueantes en la funcionalidad implementada.
7. **Integraci√≥n completa:** La funcionalidad est√° integrada correctamente con el resto del sistema.
8. **Desplegado en ambiente de pruebas:** La funcionalidad est√° disponible en el ambiente de pruebas para validaci√≥n.

---

## üì¶ EPICS

### EPIC-01: Autenticaci√≥n y Gesti√≥n de Usuarios
**Descripci√≥n:** Sistema completo de autenticaci√≥n, registro y gesti√≥n de usuarios con control de acceso basado en roles.

### EPIC-02: Gesti√≥n de Env√≠os
**Descripci√≥n:** Funcionalidades completas para crear, modificar, eliminar, consultar y gestionar env√≠os con sus productos asociados.

### EPIC-03: B√∫squeda Tradicional
**Descripci√≥n:** Sistema de b√∫squeda por texto en usuarios, env√≠os y productos con historial de b√∫squedas.

### EPIC-04: B√∫squeda Sem√°ntica
**Descripci√≥n:** Sistema de b√∫squeda sem√°ntica usando embeddings y lenguaje natural para encontrar env√≠os relevantes.

### EPIC-05: Importaci√≥n de Archivos Excel
**Descripci√≥n:** Sistema para cargar, validar e importar env√≠os desde archivos Excel.

### EPIC-06: Reportes y Estad√≠sticas
**Descripci√≥n:** Generaci√≥n de reportes exportables y visualizaci√≥n de estad√≠sticas del sistema.

### EPIC-07: Sistema de Notificaciones
**Descripci√≥n:** Sistema de notificaciones para informar a usuarios sobre cambios en env√≠os.

### EPIC-08: Infraestructura y Seguridad
**Descripci√≥n:** Configuraci√≥n de seguridad, arquitectura en capas, integraci√≥n con Supabase y APIs externas.

---

## üë§ HISTORIAS DE USUARIO

### EPIC-01: Autenticaci√≥n y Gesti√≥n de Usuarios

| ID | Nombre | Tipo | Descripci√≥n | Prioridad | M√≥dulo | Criterios de Aceptaci√≥n |
|---|---|---|---|---|---|---|
| HU-01 | Registro de Comprador | Usuario | Como **comprador** quiero **registrarme en el sistema** para **poder acceder y gestionar mis env√≠os**. | Alta | Autenticaci√≥n | 1. El sistema permite registrar compradores mediante formulario p√∫blico.<br>2. El sistema valida que la c√©dula sea √∫nica y tenga formato ecuatoriano v√°lido (10 d√≠gitos).<br>3. El sistema valida que el correo electr√≥nico sea √∫nico y tenga formato v√°lido.<br>4. El sistema valida que la contrase√±a tenga m√≠nimo 8 caracteres, may√∫sculas, min√∫sculas, n√∫meros y caracteres especiales.<br>5. El sistema almacena informaci√≥n: nombre, correo, c√©dula, tel√©fono, ubicaci√≥n geogr√°fica (provincia, cant√≥n, ciudad).<br>6. El sistema muestra mensajes de error claros cuando la validaci√≥n falla.<br>7. El sistema encripta la contrase√±a antes de almacenarla. |
| HU-02 | Inicio de Sesi√≥n | Usuario | Como **usuario** quiero **iniciar sesi√≥n en el sistema** para **acceder a mis funcionalidades**. | Alta | Autenticaci√≥n | 1. El sistema permite iniciar sesi√≥n con username y contrase√±a.<br>2. El sistema retorna tokens JWT (access token y refresh token) al autenticarse exitosamente.<br>3. El sistema bloquea el acceso despu√©s de 5 intentos fallidos por 15 minutos.<br>4. El sistema muestra mensajes de error apropiados (credenciales inv√°lidas, cuenta bloqueada, usuario desactivado).<br>5. El sistema valida que el usuario est√© activo antes de permitir el inicio de sesi√≥n.<br>6. El sistema registra todos los intentos de inicio de sesi√≥n (exitosos y fallidos) en logs. |
| HU-03 | Cierre de Sesi√≥n | Usuario | Como **usuario** quiero **cerrar sesi√≥n** para **proteger mi cuenta cuando termine de usar el sistema**. | Alta | Autenticaci√≥n | 1. El sistema permite cerrar sesi√≥n invalidando el token de acceso actual.<br>2. El sistema retorna confirmaci√≥n exitosa del cierre de sesi√≥n.<br>3. El sistema redirige al usuario a la p√°gina de login despu√©s del cierre de sesi√≥n. |
| HU-04 | Recuperaci√≥n de Contrase√±a | Usuario | Como **usuario** quiero **recuperar mi contrase√±a** para **poder acceder al sistema si la olvid√©**. | Alta | Autenticaci√≥n | 1. El sistema permite solicitar restablecimiento de contrase√±a mediante correo electr√≥nico.<br>2. El sistema valida que el correo electr√≥nico exista en el sistema antes de enviar el enlace.<br>3. El sistema genera enlaces de recuperaci√≥n con tokens seguros y expiraci√≥n temporal (24 horas).<br>4. El sistema env√≠a correo electr√≥nico con enlace de recuperaci√≥n.<br>5. El sistema permite establecer nueva contrase√±a mediante el enlace de recuperaci√≥n.<br>6. El sistema valida que la nueva contrase√±a cumpla con los requisitos de seguridad. |
| HU-05 | Cambio de Contrase√±a | Usuario | Como **usuario autenticado** quiero **cambiar mi contrase√±a** para **mantener la seguridad de mi cuenta**. | Alta | Autenticaci√≥n | 1. El sistema permite a usuarios autenticados cambiar su contrase√±a actual.<br>2. El sistema requiere la contrase√±a actual para autorizar el cambio.<br>3. El sistema valida que la nueva contrase√±a cumpla con los requisitos de seguridad.<br>4. El sistema muestra mensaje de confirmaci√≥n cuando la contrase√±a se cambia exitosamente.<br>5. El sistema requiere que el usuario inicie sesi√≥n nuevamente despu√©s del cambio. |
| HU-06 | Crear Usuario | Usuario | Como **administrador** quiero **crear nuevos usuarios** para **gestionar el acceso al sistema**. | Alta | Gesti√≥n de Usuarios | 1. El sistema permite crear usuarios con todos los campos requeridos (nombre, correo, c√©dula, rol, etc.).<br>2. El sistema valida que solo administradores puedan crear usuarios con cualquier rol.<br>3. El sistema valida unicidad de c√©dula y correo electr√≥nico.<br>4. El sistema asigna contrase√±a temporal o permite establecer contrase√±a inicial.<br>5. El sistema registra la creaci√≥n del usuario en el log de auditor√≠a. |
| HU-07 | Listar Usuarios | Usuario | Como **administrador o gerente** quiero **listar usuarios** para **ver y gestionar los usuarios del sistema**. | Alta | Gesti√≥n de Usuarios | 1. El sistema lista usuarios con paginaci√≥n (10 por p√°gina por defecto).<br>2. El sistema aplica filtros autom√°ticos seg√∫n el rol: gerentes no ven administradores, digitadores solo ven compradores y otros digitadores.<br>3. El sistema permite filtrar por rol, estado activo, y ubicaci√≥n.<br>4. El sistema muestra informaci√≥n resumida: nombre, correo, c√©dula, rol, estado, ubicaci√≥n.<br>5. El sistema permite ordenar por nombre, fecha de creaci√≥n, rol. |
| HU-08 | Consultar Usuario | Usuario | Como **usuario autenticado** quiero **consultar detalles de un usuario** para **ver su informaci√≥n completa**. | Alta | Gesti√≥n de Usuarios | 1. El sistema permite consultar detalles de un usuario espec√≠fico por ID.<br>2. El sistema valida permisos: compradores solo pueden ver su propio perfil, otros roles seg√∫n sus permisos.<br>3. El sistema muestra informaci√≥n completa: datos personales, ubicaci√≥n, estad√≠sticas (si aplica), fecha de creaci√≥n. |
| HU-09 | Actualizar Usuario | Usuario | Como **administrador o gerente** quiero **actualizar informaci√≥n de usuarios** para **mantener los datos actualizados**. | Alta | Gesti√≥n de Usuarios | 1. El sistema permite actualizar informaci√≥n de usuarios (parcial o completa).<br>2. El sistema valida permisos: solo administradores pueden modificar administradores.<br>3. El sistema valida que c√©dula y correo sigan siendo √∫nicos si se modifican.<br>4. El sistema registra la actualizaci√≥n en el log de auditor√≠a. |
| HU-10 | Eliminar Usuario | Usuario | Como **administrador** quiero **eliminar usuarios** para **remover usuarios que ya no necesitan acceso**. | Media | Gesti√≥n de Usuarios | 1. El sistema permite eliminar usuarios (eliminaci√≥n l√≥gica o f√≠sica seg√∫n configuraci√≥n).<br>2. El sistema valida que solo administradores puedan eliminar usuarios.<br>3. El sistema muestra confirmaci√≥n antes de eliminar.<br>4. El sistema registra la eliminaci√≥n en el log de auditor√≠a. |
| HU-11 | Activar/Desactivar Usuario | Usuario | Como **administrador o gerente** quiero **activar o desactivar usuarios** para **controlar el acceso sin eliminar la cuenta**. | Alta | Gesti√≥n de Usuarios | 1. El sistema permite activar o desactivar usuarios mediante un endpoint espec√≠fico.<br>2. El sistema valida permisos: solo administradores y gerentes pueden realizar esta acci√≥n.<br>3. El sistema impide el inicio de sesi√≥n de usuarios desactivados.<br>4. El sistema registra la acci√≥n en el log de auditor√≠a. |
| HU-12 | Consultar Perfil Propio | Usuario | Como **usuario autenticado** quiero **consultar mi perfil** para **ver mi informaci√≥n personal**. | Alta | Gesti√≥n de Usuarios | 1. El sistema permite a usuarios autenticados consultar su perfil completo mediante endpoint `/api/usuarios/perfil/`.<br>2. El sistema muestra toda la informaci√≥n personal: nombre, correo, c√©dula, tel√©fono, ubicaci√≥n, rol, estad√≠sticas personales.<br>3. El sistema muestra estad√≠sticas: env√≠os realizados, cupo utilizado (para compradores). |
| HU-13 | Actualizar Perfil Propio | Usuario | Como **usuario autenticado** quiero **actualizar mi perfil** para **mantener mi informaci√≥n actualizada**. | Alta | Gesti√≥n de Usuarios | 1. El sistema permite actualizar informaci√≥n personal: nombre, tel√©fono, direcci√≥n, ubicaci√≥n geogr√°fica.<br>2. El sistema valida que el usuario solo pueda modificar su propio perfil (excepto administradores).<br>3. El sistema permite actualizar ubicaci√≥n seleccionando provincia, cant√≥n y ciudad de Ecuador.<br>4. El sistema muestra confirmaci√≥n cuando la actualizaci√≥n es exitosa. |

### EPIC-02: Gesti√≥n de Env√≠os

| ID | Nombre | Tipo | Descripci√≥n | Prioridad | M√≥dulo | Criterios de Aceptaci√≥n |
|---|---|---|---|---|---|---|
| HU-14 | Crear Env√≠o | Usuario | Como **digitador o comprador** quiero **crear un nuevo env√≠o** para **registrar un env√≠o con sus productos**. | Alta | Gesti√≥n de Env√≠os | 1. El sistema permite crear env√≠os con n√∫mero √∫nico de gu√≠a a√©rea (HAWB).<br>2. El sistema valida que el HAWB sea √∫nico en el sistema.<br>3. El sistema asocia cada env√≠o a un comprador espec√≠fico.<br>4. El sistema permite registrar observaciones y fecha de emisi√≥n.<br>5. El sistema calcula autom√°ticamente totales (peso, cantidad, valor) bas√°ndose en productos asociados.<br>6. El sistema calcula autom√°ticamente el costo del servicio seg√∫n tarifas aplicables.<br>7. El sistema valida que el comprador no exceda su cupo anual al crear un env√≠o.<br>8. El sistema genera autom√°ticamente un embedding para b√∫squeda sem√°ntica cuando se crea un env√≠o. |
| HU-15 | Listar Env√≠os | Usuario | Como **usuario autenticado** quiero **listar env√≠os** para **ver los env√≠os disponibles seg√∫n mis permisos**. | Alta | Gesti√≥n de Env√≠os | 1. El sistema lista env√≠os con paginaci√≥n (10 elementos por p√°gina por defecto).<br>2. El sistema aplica filtros autom√°ticos seg√∫n el rol: compradores solo ven sus env√≠os, otros roles ven todos los env√≠os.<br>3. El sistema permite ordenar por fecha, estado, valor, peso.<br>4. El sistema muestra informaci√≥n resumida: HAWB, comprador, estado, fecha, totales, cantidad de productos.<br>5. El sistema muestra contadores de productos asociados a cada env√≠o. |
| HU-16 | Consultar Env√≠o | Usuario | Como **usuario autenticado** quiero **consultar detalles de un env√≠o** para **ver toda su informaci√≥n y productos**. | Alta | Gesti√≥n de Env√≠os | 1. El sistema permite consultar detalles de un env√≠o espec√≠fico por ID.<br>2. El sistema valida permisos: compradores solo pueden ver sus propios env√≠os.<br>3. El sistema muestra informaci√≥n completa: HAWB, comprador, productos, totales, estado, observaciones, fechas.<br>4. El sistema muestra historial de cambios de estado si existe. |
| HU-17 | Actualizar Env√≠o | Usuario | Como **digitador o comprador** quiero **actualizar un env√≠o** para **modificar su informaci√≥n o productos**. | Alta | Gesti√≥n de Env√≠os | 1. El sistema permite actualizar informaci√≥n de env√≠os (parcial o completa).<br>2. El sistema valida permisos: compradores solo pueden modificar sus propios env√≠os.<br>3. El sistema recalcula autom√°ticamente totales cuando se modifican productos asociados.<br>4. El sistema recalcula el costo del servicio cuando cambian productos o tarifas.<br>5. El sistema actualiza el embedding sem√°ntico cuando se modifica informaci√≥n relevante del env√≠o. |
| HU-18 | Eliminar Env√≠o | Usuario | Como **digitador o administrador** quiero **eliminar un env√≠o** para **remover env√≠os incorrectos o duplicados**. | Media | Gesti√≥n de Env√≠os | 1. El sistema permite eliminar env√≠os (eliminaci√≥n l√≥gica o f√≠sica seg√∫n configuraci√≥n).<br>2. El sistema valida permisos antes de permitir la eliminaci√≥n.<br>3. El sistema muestra confirmaci√≥n antes de eliminar.<br>4. El sistema elimina o desactiva los productos asociados al env√≠o.<br>5. El sistema registra la eliminaci√≥n en el log de auditor√≠a. |
| HU-19 | Cambiar Estado de Env√≠o | Usuario | Como **digitador o gerente** quiero **cambiar el estado de un env√≠o** para **actualizar su progreso en el proceso de env√≠o**. | Alta | Gesti√≥n de Env√≠os | 1. El sistema permite cambiar el estado de un env√≠o mediante endpoint espec√≠fico.<br>2. El sistema define estados: Pendiente, En Tr√°nsito, Entregado, Cancelado, Retenido, Devuelto.<br>3. El sistema valida transiciones de estado v√°lidas (ej: no se puede cambiar de "Entregado" a "Pendiente").<br>4. El sistema registra cada cambio de estado con fecha, hora y usuario que realiz√≥ el cambio.<br>5. El sistema genera notificaciones autom√°ticas cuando cambia el estado (especialmente para compradores).<br>6. El sistema permite agregar observaciones al cambiar el estado. |
| HU-20 | Filtrar Env√≠os | Usuario | Como **usuario autenticado** quiero **filtrar env√≠os** para **encontrar env√≠os espec√≠ficos r√°pidamente**. | Alta | Gesti√≥n de Env√≠os | 1. El sistema permite filtrar por estado (pendiente, en tr√°nsito, entregado, cancelado, etc.).<br>2. El sistema permite filtrar por rango de fechas (fecha desde, fecha hasta).<br>3. El sistema permite filtrar por cliente/comprador (nombre, c√©dula, correo).<br>4. El sistema permite filtrar por ubicaci√≥n (provincia, cant√≥n, ciudad).<br>5. El sistema permite filtrar por n√∫mero de gu√≠a (HAWB).<br>6. El sistema permite combinar m√∫ltiples filtros simult√°neamente.<br>7. El sistema permite b√∫squeda por texto libre que busque en m√∫ltiples campos. |
| HU-21 | Generar Comprobante de Env√≠o | Usuario | Como **usuario autenticado** quiero **generar un comprobante PDF de un env√≠o** para **tener un documento oficial del env√≠o**. | Media | Gesti√≥n de Env√≠os | 1. El sistema genera un comprobante PDF con toda la informaci√≥n del env√≠o.<br>2. El comprobante incluye: HAWB, informaci√≥n del comprador, productos, totales, estado, fecha.<br>3. El comprobante tiene formato profesional y listo para impresi√≥n.<br>4. El sistema permite descargar el comprobante desde la interfaz mediante endpoint `/api/envios/envios/{id}/comprobante/`. |

### EPIC-02: Gesti√≥n de Productos

| ID | Nombre | Tipo | Descripci√≥n | Prioridad | M√≥dulo | Criterios de Aceptaci√≥n |
|---|---|---|---|---|---|---|
| HU-22 | Crear Producto | Usuario | Como **digitador o comprador** quiero **crear productos asociados a un env√≠o** para **registrar los productos que contiene el env√≠o**. | Alta | Gesti√≥n de Productos | 1. El sistema permite crear productos asociados a un env√≠o espec√≠fico.<br>2. Cada producto tiene: descripci√≥n, peso, cantidad, valor, categor√≠a.<br>3. El sistema define categor√≠as: Electr√≥nica, Ropa, Hogar, Deportes, Otros.<br>4. El sistema calcula autom√°ticamente el costo de env√≠o del producto seg√∫n tarifas aplicables.<br>5. El sistema recalcula los totales del env√≠o cuando se agregan productos. |
| HU-23 | Actualizar Producto | Usuario | Como **digitador o comprador** quiero **actualizar un producto** para **modificar su informaci√≥n**. | Alta | Gesti√≥n de Productos | 1. El sistema permite actualizar cualquier campo de un producto.<br>2. El sistema recalcula autom√°ticamente el costo de env√≠o cuando cambia el peso o la categor√≠a.<br>3. El sistema recalcula los totales del env√≠o padre cuando se modifica un producto. |
| HU-24 | Eliminar Producto | Usuario | Como **digitador o comprador** quiero **eliminar un producto de un env√≠o** para **remover productos incorrectos**. | Alta | Gesti√≥n de Productos | 1. El sistema permite eliminar productos individuales.<br>2. El sistema recalcula autom√°ticamente los totales del env√≠o despu√©s de eliminar un producto.<br>3. El sistema valida que el env√≠o tenga al menos un producto (o permite env√≠os sin productos seg√∫n reglas de negocio). |
| HU-25 | Listar Productos | Usuario | Como **usuario autenticado** quiero **listar productos** para **ver todos los productos del sistema**. | Media | Gesti√≥n de Productos | 1. El sistema lista todos los productos con paginaci√≥n.<br>2. El sistema permite filtrar productos por categor√≠a, env√≠o, rango de peso, rango de valor.<br>3. El sistema permite buscar productos por descripci√≥n.<br>4. El sistema muestra estad√≠sticas de productos por categor√≠a. |

### EPIC-03: B√∫squeda Tradicional

| ID | Nombre | Tipo | Descripci√≥n | Prioridad | M√≥dulo | Criterios de Aceptaci√≥n |
|---|---|---|---|---|---|---|
| HU-26 | B√∫squeda Tradicional | Usuario | Como **usuario autenticado** quiero **realizar b√∫squedas por texto** para **encontrar usuarios, env√≠os o productos r√°pidamente**. | Alta | B√∫squeda | 1. El sistema permite b√∫squedas generales que buscan en todos los tipos de entidades (usuarios, env√≠os, productos).<br>2. El sistema permite b√∫squedas espec√≠ficas por tipo: usuarios, env√≠os, productos.<br>3. El sistema aplica filtros de permisos seg√∫n el rol del usuario.<br>4. El sistema muestra resultados agrupados por tipo de entidad.<br>5. El sistema muestra el total de resultados encontrados.<br>6. El sistema registra cada b√∫squeda en el historial. |
| HU-27 | Consultar Historial de B√∫squedas Tradicionales | Usuario | Como **usuario autenticado** quiero **consultar mi historial de b√∫squedas** para **ver mis b√∫squedas anteriores**. | Media | B√∫squeda | 1. El sistema permite consultar el historial de b√∫squedas del usuario actual.<br>2. El sistema muestra: t√©rmino buscado, tipo, fecha, resultados encontrados.<br>3. El sistema permite limpiar el historial de b√∫squedas.<br>4. El sistema proporciona estad√≠sticas: t√©rminos m√°s buscados, tipos m√°s usados. |

### EPIC-04: B√∫squeda Sem√°ntica

| ID | Nombre | Tipo | Descripci√≥n | Prioridad | M√≥dulo | Criterios de Aceptaci√≥n |
|---|---|---|---|---|---|---|
| HU-28 | B√∫squeda Sem√°ntica | Usuario | Como **usuario autenticado** quiero **realizar b√∫squedas sem√°nticas usando lenguaje natural** para **encontrar env√≠os relevantes aunque no use las palabras exactas**. | Alta | B√∫squeda Sem√°ntica | 1. El sistema permite realizar b√∫squedas usando lenguaje natural (consultas en espa√±ol).<br>2. El sistema genera un embedding de la consulta del usuario.<br>3. El sistema busca env√≠os similares usando b√∫squeda vectorial (similitud coseno).<br>4. El sistema retorna resultados ordenados por relevancia sem√°ntica.<br>5. El sistema muestra puntuaciones de similitud para cada resultado.<br>6. El sistema procesa y normaliza el texto de la consulta antes de generar el embedding.<br>7. El tiempo de respuesta de la b√∫squeda es menor a 1 minuto. |
| HU-29 | Refinar B√∫squeda Sem√°ntica | Usuario | Como **usuario autenticado** quiero **aplicar filtros a mi b√∫squeda sem√°ntica** para **obtener resultados m√°s precisos**. | Alta | B√∫squeda Sem√°ntica | 1. El sistema permite aplicar filtros por fecha (desde, hasta).<br>2. El sistema permite filtrar por estado del env√≠o.<br>3. El sistema permite filtrar por remitente/comprador.<br>4. El sistema permite filtrar por ubicaci√≥n (ciudad destino).<br>5. El sistema combina la b√∫squeda sem√°ntica con los filtros aplicados.<br>6. El sistema respeta los l√≠mites de permisos seg√∫n el rol del usuario. |
| HU-30 | Consultar Historial de B√∫squedas Sem√°nticas | Usuario | Como **usuario autenticado** quiero **consultar mi historial de b√∫squedas sem√°nticas** para **ver mis consultas anteriores y resultados**. | Media | B√∫squeda Sem√°ntica | 1. El sistema permite consultar el historial de b√∫squedas sem√°nticas del usuario.<br>2. El sistema muestra: consulta, fecha, resultados encontrados, tiempo de respuesta, modelo utilizado, costo, tokens utilizados.<br>3. El sistema permite limpiar el historial de b√∫squedas sem√°nticas.<br>4. El sistema proporciona sugerencias basadas en b√∫squedas anteriores. |

### EPIC-05: Importaci√≥n de Archivos Excel

| ID | Nombre | Tipo | Descripci√≥n | Prioridad | M√≥dulo | Criterios de Aceptaci√≥n |
|---|---|---|---|---|---|---|
| HU-31 | Cargar Archivo Excel | Usuario | Como **digitador o administrador** quiero **cargar un archivo Excel** para **importar m√∫ltiples env√≠os de forma masiva**. | Alta | Importaci√≥n | 1. El sistema permite cargar archivos en formato .xlsx y .xls.<br>2. El sistema valida el tama√±o m√°ximo del archivo (15 MB).<br>3. El sistema valida la estructura del archivo (columnas requeridas, formato de datos).<br>4. El sistema procesa el archivo y extrae informaci√≥n de env√≠os y productos.<br>5. El sistema muestra un resumen previo de los datos a importar antes de confirmar.<br>6. El sistema reporta errores de validaci√≥n de forma clara y espec√≠fica. |
| HU-32 | Validar y Confirmar Importaci√≥n | Usuario | Como **digitador o administrador** quiero **validar y confirmar la importaci√≥n** para **asegurarme de que los datos son correctos antes de importarlos**. | Alta | Importaci√≥n | 1. El sistema valida que el archivo tenga las columnas requeridas.<br>2. El sistema valida formatos de datos (fechas, n√∫meros, texto).<br>3. El sistema valida que los datos cumplan con reglas de negocio (HAWB √∫nico, comprador existente, etc.).<br>4. El sistema muestra resumen: n√∫mero de registros v√°lidos, n√∫mero de errores.<br>5. El sistema permite confirmar o cancelar la importaci√≥n.<br>6. El sistema almacena el archivo original en Supabase Storage.<br>7. El sistema registra metadatos de la importaci√≥n: fecha, usuario, n√∫mero de registros, estado. |
| HU-33 | Consultar Historial de Importaciones | Usuario | Como **administrador o gerente** quiero **consultar el historial de importaciones** para **ver las importaciones realizadas**. | Media | Importaci√≥n | 1. El sistema permite consultar el historial de importaciones.<br>2. El sistema muestra: fecha, usuario, nombre del archivo, n√∫mero de registros procesados, n√∫mero de registros exitosos, n√∫mero de errores, estado.<br>3. El sistema permite filtrar el historial por fecha, usuario, estado (√©xito/error).<br>4. El sistema permite descargar reportes de importaciones anteriores. |

### EPIC-06: Reportes y Estad√≠sticas

| ID | Nombre | Tipo | Descripci√≥n | Prioridad | M√≥dulo | Criterios de Aceptaci√≥n |
|---|---|---|---|---|---|---|
| HU-34 | Exportar Env√≠os a Excel | Usuario | Como **usuario autenticado** quiero **exportar env√≠os a Excel** para **tener los datos en formato de hoja de c√°lculo**. | Alta | Reportes | 1. El sistema permite exportar listados de env√≠os en formato Excel (.xlsx).<br>2. El sistema aplica los mismos filtros de la vista actual al exportar.<br>3. El sistema incluye informaci√≥n completa: HAWB, comprador, productos, totales, estado, fechas.<br>4. El sistema formatea el reporte con encabezados, estilos y formato profesional. |
| HU-35 | Exportar Env√≠os a PDF | Usuario | Como **usuario autenticado** quiero **exportar env√≠os a PDF** para **tener un documento listo para impresi√≥n**. | Alta | Reportes | 1. El sistema permite exportar listados de env√≠os en formato PDF.<br>2. El sistema aplica los mismos filtros de la vista actual al exportar.<br>3. El sistema incluye informaci√≥n completa con formato profesional.<br>4. El sistema incluye res√∫menes de totales (peso total, valor total, costo total) en el PDF. |
| HU-36 | Exportar Env√≠os a CSV | Usuario | Como **usuario autenticado** quiero **exportar env√≠os a CSV** para **importar los datos en otros sistemas**. | Media | Reportes | 1. El sistema permite exportar listados de env√≠os en formato CSV.<br>2. El sistema aplica los mismos filtros de la vista actual al exportar.<br>3. El archivo CSV tiene codificaci√≥n UTF-8 y formato compatible con Excel. |
| HU-37 | Ver M√©tricas Generales | Usuario | Como **administrador o gerente** quiero **ver m√©tricas generales del sistema** para **conocer el estado y rendimiento del sistema**. | Alta | Estad√≠sticas | 1. El sistema muestra el n√∫mero total de env√≠os.<br>2. El sistema muestra la distribuci√≥n de env√≠os por estado.<br>3. El sistema muestra m√©tricas de rendimiento (env√≠os por mes, tendencias).<br>4. El sistema muestra volumen mensual de env√≠os.<br>5. El sistema muestra estad√≠sticas de usuarios por rol.<br>6. Las m√©tricas se actualizan en tiempo real. |
| HU-38 | Ver Dashboard Personalizado | Usuario | Como **usuario autenticado** quiero **ver un dashboard personalizado** para **tener una vista resumida de mi informaci√≥n relevante**. | Alta | Estad√≠sticas | 1. El sistema muestra un dashboard diferente seg√∫n el rol del usuario.<br>2. Para compradores: muestra sus env√≠os, cupo utilizado, estad√≠sticas personales.<br>3. Para administradores y gerentes: muestra m√©tricas globales, estad√≠sticas generales.<br>4. El sistema permite filtrar el dashboard por a√±o.<br>5. El sistema muestra gr√°ficos y visualizaciones de datos. |
| HU-39 | Ver Estad√≠sticas de Cupo Anual | Usuario | Como **comprador** quiero **ver mis estad√≠sticas de cupo anual** para **saber cu√°nto cupo he utilizado y cu√°nto me queda**. | Alta | Estad√≠sticas | 1. El sistema muestra el cupo anual asignado al comprador.<br>2. El sistema muestra el peso total utilizado en el a√±o actual.<br>3. El sistema muestra el porcentaje de cupo utilizado.<br>4. El sistema muestra el peso restante disponible.<br>5. El sistema valida el cupo antes de permitir crear nuevos env√≠os. |

### EPIC-07: Sistema de Notificaciones

| ID | Nombre | Tipo | Descripci√≥n | Prioridad | M√≥dulo | Criterios de Aceptaci√≥n |
|---|---|---|---|---|---|---|
| HU-40 | Recibir Notificaciones de Env√≠os | Usuario | Como **comprador** quiero **recibir notificaciones cuando se crea o modifica un env√≠o** para **estar informado de los cambios**. | Alta | Notificaciones | 1. El sistema genera notificaciones autom√°ticas cuando se crea un env√≠o para un comprador.<br>2. El sistema genera notificaciones cuando cambia el estado de un env√≠o.<br>3. El sistema genera notificaciones cuando se asigna un env√≠o a un comprador.<br>4. Las notificaciones se almacenan en la base de datos.<br>5. El sistema muestra notificaciones en tiempo real mediante polling. |
| HU-41 | Ver Notificaciones | Usuario | Como **usuario autenticado** quiero **ver mis notificaciones** para **estar al tanto de los eventos relevantes**. | Alta | Notificaciones | 1. El sistema permite listar todas las notificaciones del usuario autenticado.<br>2. El sistema permite filtrar notificaciones por tipo (nuevo env√≠o, estado cambiado, general).<br>3. El sistema muestra un contador de notificaciones no le√≠das.<br>4. El sistema permite consultar notificaciones recientes (√∫ltimas 10, 20, 50).<br>5. El sistema actualiza las notificaciones en tiempo real. |
| HU-42 | Marcar Notificaciones como Le√≠das | Usuario | Como **usuario autenticado** quiero **marcar notificaciones como le√≠das** para **gestionar qu√© notificaciones ya he visto**. | Alta | Notificaciones | 1. El sistema permite marcar una notificaci√≥n individual como le√≠da.<br>2. El sistema permite marcar todas las notificaciones como le√≠das.<br>3. El sistema actualiza el contador de notificaciones no le√≠das autom√°ticamente.<br>4. El sistema registra la fecha de lectura de cada notificaci√≥n. |
| HU-43 | Eliminar Notificaciones | Usuario | Como **usuario autenticado** quiero **eliminar notificaciones** para **limpiar mi lista de notificaciones**. | Media | Notificaciones | 1. El sistema permite eliminar notificaciones individuales.<br>2. El sistema actualiza el contador de notificaciones despu√©s de eliminar. |

---

## üîß HISTORIAS T√âCNICAS

### EPIC-08: Infraestructura y Seguridad

| ID | Nombre | Tipo | Descripci√≥n | Prioridad | M√≥dulo | Criterios de Aceptaci√≥n |
|---|---|---|---|---|---|---|
| HT-01 | Configurar Autenticaci√≥n JWT | T√©cnica | Como **desarrollador** quiero **configurar autenticaci√≥n JWT** para **proporcionar seguridad en las comunicaciones del sistema**. | Alta | Infraestructura | 1. El sistema utiliza Django REST Framework Simple JWT para autenticaci√≥n.<br>2. El sistema genera tokens de acceso con tiempo de expiraci√≥n apropiado (15 minutos).<br>3. El sistema genera refresh tokens con tiempo de expiraci√≥n m√°s largo (7 d√≠as).<br>4. El sistema valida la firma y expiraci√≥n de tokens en cada solicitud.<br>5. El sistema invalida tokens cuando el usuario cierra sesi√≥n.<br>6. El sistema implementa middleware para validar tokens en todas las solicitudes protegidas. |
| HT-02 | Implementar Control de Acceso Basado en Roles (RBAC) | T√©cnica | Como **desarrollador** quiero **implementar RBAC** para **restringir el acceso seg√∫n el rol del usuario**. | Alta | Infraestructura | 1. El sistema implementa permisos personalizados para cada rol (Administrador, Gerente, Digitador, Comprador).<br>2. El sistema valida permisos en cada endpoint antes de procesar la solicitud.<br>3. El sistema retorna mensajes de error apropiados (403 Forbidden) cuando un usuario intenta acceder a funcionalidades no permitidas.<br>4. El sistema implementa decoradores o mixins para verificar permisos en views.<br>5. El sistema implementa filtros autom√°ticos en querysets seg√∫n el rol del usuario. |
| HT-03 | Configurar Encriptaci√≥n de Contrase√±as | T√©cnica | Como **desarrollador** quiero **configurar encriptaci√≥n de contrase√±as** para **proteger las credenciales de los usuarios**. | Alta | Seguridad | 1. El sistema utiliza bcrypt o Argon2 para encriptar contrase√±as.<br>2. El sistema nunca almacena contrase√±as en texto plano.<br>3. El sistema valida la fortaleza de contrase√±as antes de almacenarlas (m√≠nimo 8 caracteres, may√∫sculas, min√∫sculas, n√∫meros, caracteres especiales).<br>4. El sistema utiliza el sistema de autenticaci√≥n de Django para verificar contrase√±as. |
| HT-04 | Implementar Rate Limiting | T√©cnica | Como **desarrollador** quiero **implementar rate limiting** para **prevenir abuso de APIs y ataques de fuerza bruta**. | Alta | Seguridad | 1. El sistema implementa rate limiting para endpoints de autenticaci√≥n (5 intentos por minuto para login).<br>2. El sistema implementa rate limiting para b√∫squedas sem√°nticas (30 por minuto).<br>3. El sistema implementa rate limiting para b√∫squedas tradicionales (60 por minuto).<br>4. El sistema implementa rate limiting para importaciones (10 por hora).<br>5. El sistema retorna c√≥digo HTTP 429 (Too Many Requests) cuando se excede el l√≠mite.<br>6. El sistema muestra mensajes de error apropiados cuando se excede el l√≠mite. |
| HT-05 | Configurar HTTPS | T√©cnica | Como **desarrollador** quiero **configurar HTTPS** para **cifrar la comunicaci√≥n entre cliente y servidor**. | Alta | Seguridad | 1. El sistema utiliza protocolo HTTPS para todas las comunicaciones en producci√≥n.<br>2. El sistema utiliza certificados SSL/TLS v√°lidos.<br>3. El sistema redirige autom√°ticamente conexiones HTTP a HTTPS en producci√≥n.<br>4. El sistema valida certificados en el cliente para prevenir ataques man-in-the-middle. |
| HT-06 | Implementar Protecci√≥n CSRF y XSS | T√©cnica | Como **desarrollador** quiero **implementar protecciones CSRF y XSS** para **prevenir ataques comunes**. | Alta | Seguridad | 1. El sistema implementa protecci√≥n CSRF (Cross-Site Request Forgery) en todos los formularios.<br>2. El sistema sanitiza todas las entradas del usuario para prevenir XSS (Cross-Site Scripting).<br>3. El sistema valida y sanitiza datos en el backend antes de procesarlos.<br>4. El sistema utiliza escape de caracteres especiales en la salida HTML. |
| HT-07 | Implementar Arquitectura en Capas | T√©cnica | Como **desarrollador** quiero **implementar arquitectura en capas** para **mantener el c√≥digo organizado y mantenible**. | Alta | Arquitectura | 1. El sistema separa responsabilidades en capas: Views (Presentaci√≥n), Services (L√≥gica de Negocio), Repositories (Acceso a Datos), Models (Modelos).<br>2. Las capas superiores no acceden directamente a capas inferiores (ej: Views no acceden directamente a Models).<br>3. El sistema utiliza el patr√≥n Repository para abstraer el acceso a datos.<br>4. El sistema utiliza el patr√≥n Service para encapsular l√≥gica de negocio.<br>5. Cada capa tiene responsabilidades claramente definidas. |
| HT-08 | Configurar Integraci√≥n con Supabase | T√©cnica | Como **desarrollador** quiero **configurar integraci√≥n con Supabase** para **utilizar PostgreSQL y almacenamiento de archivos**. | Alta | Infraestructura | 1. El sistema utiliza Supabase como base de datos principal (PostgreSQL).<br>2. El sistema configura conexiones seguras a Supabase.<br>3. El sistema utiliza Supabase Storage para almacenamiento de archivos Excel.<br>4. El sistema utiliza pgvector (extensi√≥n de PostgreSQL) para b√∫squeda vectorial.<br>5. El sistema configura migraciones de Django para gestionar el esquema de base de datos. |
| HT-09 | Configurar Integraci√≥n con OpenAI | T√©cnica | Como **desarrollador** quiero **configurar integraci√≥n con OpenAI** para **generar embeddings para b√∫squeda sem√°ntica**. | Alta | Infraestructura | 1. El sistema se integra con la API de OpenAI para generaci√≥n de embeddings.<br>2. El sistema maneja errores y timeouts de la API de forma apropiada.<br>3. El sistema implementa retry logic para llamadas fallidas (m√°ximo 3 intentos).<br>4. El sistema registra costos y uso de la API de OpenAI.<br>5. El sistema permite configurar endpoints y credenciales de la API mediante variables de entorno.<br>6. El sistema valida que la API est√© configurada antes de intentar generar embeddings. |
| HT-10 | Implementar Generaci√≥n Autom√°tica de Embeddings | T√©cnica | Como **desarrollador** quiero **implementar generaci√≥n autom√°tica de embeddings** para **indexar env√≠os para b√∫squeda sem√°ntica**. | Alta | B√∫squeda Sem√°ntica | 1. El sistema genera embeddings autom√°ticamente cuando se crea un env√≠o.<br>2. El sistema actualiza embeddings cuando se modifica informaci√≥n relevante de un env√≠o.<br>3. El sistema almacena embeddings en la base de datos usando pgvector (VectorField).<br>4. El sistema indexa el texto completo del env√≠o (HAWB, comprador, productos, observaciones) para generar el embedding.<br>5. El sistema utiliza el modelo text-embedding-ada-002 de OpenAI por defecto.<br>6. El sistema maneja errores si la generaci√≥n de embedding falla (no bloquea la creaci√≥n del env√≠o). |
| HT-11 | Implementar B√∫squeda Vectorial | T√©cnica | Como **desarrollador** quiero **implementar b√∫squeda vectorial** para **realizar b√∫squedas sem√°nticas eficientes**. | Alta | B√∫squeda Sem√°ntica | 1. El sistema implementa b√∫squeda vectorial usando pgvector y similitud coseno.<br>2. El sistema genera embedding de la consulta del usuario.<br>3. El sistema busca env√≠os similares comparando embeddings usando distancia coseno.<br>4. El sistema retorna resultados ordenados por relevancia sem√°ntica (score de similitud).<br>5. El sistema aplica umbrales de similitud para filtrar resultados poco relevantes (umbral m√≠nimo 0.35).<br>6. El sistema limita el n√∫mero de env√≠os procesados en cada b√∫squeda (m√°ximo 300) para optimizar rendimiento.<br>7. El tiempo de respuesta de la b√∫squeda es menor a 1 minuto. |
| HT-12 | Implementar Cach√© de Embeddings | T√©cnica | Como **desarrollador** quiero **implementar cach√© de embeddings** para **optimizar el rendimiento y reducir costos**. | Media | B√∫squeda Sem√°ntica | 1. El sistema cachea embeddings de consultas similares para evitar llamadas redundantes a OpenAI.<br>2. El sistema cachea datos frecuentemente consultados (listas de ubicaciones, estad√≠sticas).<br>3. El sistema implementa invalidaci√≥n de cach√© cuando los datos cambian.<br>4. El sistema utiliza Redis o Memcached para cach√© distribuido en producci√≥n. |
| HT-13 | Implementar Sistema de Logs | T√©cnica | Como **desarrollador** quiero **implementar sistema de logs** para **registrar operaciones y facilitar debugging**. | Alta | Infraestructura | 1. El sistema registra logs de todas las operaciones importantes (creaci√≥n, modificaci√≥n, eliminaci√≥n de entidades).<br>2. El sistema utiliza niveles de log apropiados (DEBUG, INFO, WARNING, ERROR, CRITICAL).<br>3. El sistema formatea logs de forma estructurada (JSON preferiblemente).<br>4. El sistema permite filtrar y buscar en logs.<br>5. El sistema rota logs para evitar llenar el disco.<br>6. El sistema registra: usuario, operaci√≥n, entidad, fecha/hora, detalles adicionales. |
| HT-14 | Implementar Manejador de Excepciones Centralizado | T√©cnica | Como **desarrollador** quiero **implementar manejador de excepciones centralizado** para **manejar errores de forma consistente**. | Alta | Infraestructura | 1. El sistema implementa un manejador de excepciones centralizado en Django REST Framework.<br>2. El sistema captura y maneja todos los errores sin exponer informaci√≥n sensible.<br>3. El sistema retorna mensajes de error claros y √∫tiles para el usuario.<br>4. El sistema registra errores en logs para debugging.<br>5. El sistema retorna c√≥digos de estado HTTP apropiados (400, 401, 403, 404, 500, etc.). |
| HT-15 | Implementar Validaci√≥n de Datos | T√©cnica | Como **desarrollador** quiero **implementar validaci√≥n de datos** para **asegurar la integridad de los datos**. | Alta | Infraestructura | 1. El sistema valida datos en el frontend (validaci√≥n del cliente).<br>2. El sistema valida datos en el backend (validaci√≥n del servidor, nunca confiar solo en el cliente).<br>3. El sistema utiliza serializers de Django REST Framework para validaci√≥n.<br>4. El sistema retorna mensajes de error de validaci√≥n claros y espec√≠ficos.<br>5. El sistema valida tipos de datos, rangos, formatos y reglas de negocio. |
| HT-16 | Configurar Paginaci√≥n | T√©cnica | Como **desarrollador** quiero **configurar paginaci√≥n** para **optimizar el rendimiento de listados**. | Alta | Infraestructura | 1. El sistema implementa paginaci√≥n en todos los listados (10 elementos por p√°gina por defecto).<br>2. El sistema permite configurar el tama√±o de p√°gina mediante par√°metros de query.<br>3. El sistema retorna metadatos de paginaci√≥n: count, next, previous, results.<br>4. El sistema utiliza CustomPageNumberPagination de Django REST Framework. |
| HT-17 | Implementar Optimizaci√≥n de Consultas | T√©cnica | Como **desarrollador** quiero **optimizar consultas a la base de datos** para **mejorar el rendimiento**. | Alta | Infraestructura | 1. El sistema utiliza select_related y prefetch_related para optimizar consultas relacionadas.<br>2. El sistema utiliza √≠ndices en la base de datos para optimizar consultas frecuentes.<br>3. El sistema limita el n√∫mero de resultados retornados por defecto.<br>4. El sistema evita consultas N+1 utilizando eager loading. |
| HT-18 | Configurar Documentaci√≥n de API (Swagger/OpenAPI) | T√©cnica | Como **desarrollador** quiero **configurar documentaci√≥n autom√°tica de la API** para **facilitar el uso y mantenimiento**. | Alta | Infraestructura | 1. El sistema genera documentaci√≥n autom√°tica usando drf-spectacular (OpenAPI/Swagger).<br>2. El sistema proporciona ejemplos de uso para cada endpoint.<br>3. El sistema documenta par√°metros, respuestas y c√≥digos de error.<br>4. El sistema est√° accesible en `/api/docs/` (Swagger UI) y `/api/redoc/` (ReDoc).<br>5. El sistema actualiza la documentaci√≥n autom√°ticamente cuando se modifican los endpoints. |
| HT-19 | Implementar Sistema de Ubicaciones Geogr√°ficas | T√©cnica | Como **desarrollador** quiero **implementar sistema de ubicaciones geogr√°ficas** para **gestionar provincias, cantones y ciudades de Ecuador**. | Alta | Infraestructura | 1. El sistema implementa estructura jer√°rquica: Provincia ‚Üí Cant√≥n ‚Üí Ciudad.<br>2. El sistema proporciona endpoints para obtener provincias, cantones y ciudades.<br>3. El sistema almacena coordenadas geogr√°ficas (latitud, longitud) para cada ciudad.<br>4. El sistema permite buscar ciudades por nombre.<br>5. El sistema asocia usuarios y env√≠os con ubicaciones geogr√°ficas. |
| HT-20 | Implementar Sistema de Tarifas | T√©cnica | Como **desarrollador** quiero **implementar sistema de tarifas** para **calcular costos de env√≠o autom√°ticamente**. | Alta | Infraestructura | 1. El sistema permite crear, modificar y eliminar tarifas.<br>2. Cada tarifa tiene: categor√≠a de producto, peso m√≠nimo, peso m√°ximo, cargo base, precio por kilogramo.<br>3. El sistema calcula autom√°ticamente el costo de env√≠o de productos seg√∫n las tarifas aplicables.<br>4. El sistema valida que exista una tarifa activa para cada categor√≠a y rango de peso.<br>5. El sistema permite activar/desactivar tarifas.<br>6. El sistema recalcula costos autom√°ticamente cuando cambian productos o tarifas. |
| HT-21 | Implementar Procesamiento de Archivos Excel | T√©cnica | Como **desarrollador** quiero **implementar procesamiento de archivos Excel** para **importar env√≠os masivamente**. | Alta | Importaci√≥n | 1. El sistema procesa archivos en formato .xlsx y .xls usando openpyxl o pandas.<br>2. El sistema valida el tama√±o m√°ximo del archivo (15 MB).<br>3. El sistema valida la estructura del archivo (columnas requeridas).<br>4. El sistema valida formatos de datos (fechas, n√∫meros, texto).<br>5. El sistema valida reglas de negocio (HAWB √∫nico, comprador existente, etc.).<br>6. El sistema almacena el archivo original en Supabase Storage.<br>7. El sistema registra metadatos de la importaci√≥n en la base de datos. |
| HT-22 | Implementar Generaci√≥n de Reportes PDF | T√©cnica | Como **desarrollador** quiero **implementar generaci√≥n de reportes PDF** para **exportar datos en formato de documento**. | Alta | Reportes | 1. El sistema genera reportes PDF usando reportlab o similar.<br>2. El sistema formatea los reportes con encabezados, estilos y dise√±o profesional.<br>3. El sistema incluye res√∫menes de totales en los reportes PDF.<br>4. El sistema optimiza el dise√±o para tama√±o A4.<br>5. El sistema permite descargar los reportes PDF desde la interfaz. |
| HT-23 | Implementar Generaci√≥n de Reportes Excel | T√©cnica | Como **desarrollador** quiero **implementar generaci√≥n de reportes Excel** para **exportar datos en formato de hoja de c√°lculo**. | Alta | Reportes | 1. El sistema genera reportes Excel usando openpyxl.<br>2. El sistema formatea los reportes con encabezados, colores y estilos.<br>3. El sistema incluye filtros autom√°ticos en las columnas.<br>4. El sistema ajusta el ancho de las columnas autom√°ticamente.<br>5. El sistema permite descargar los reportes Excel desde la interfaz. |
| HT-24 | Implementar Sistema de Notificaciones | T√©cnica | Como **desarrollador** quiero **implementar sistema de notificaciones** para **informar a usuarios sobre eventos importantes**. | Alta | Notificaciones | 1. El sistema crea notificaciones autom√°ticamente cuando se crea un env√≠o para un comprador.<br>2. El sistema crea notificaciones cuando cambia el estado de un env√≠o.<br>3. El sistema almacena notificaciones en la base de datos con: usuario, tipo, t√≠tulo, mensaje, enlace, metadata.<br>4. El sistema permite marcar notificaciones como le√≠das.<br>5. El sistema implementa polling o WebSockets para actualizar notificaciones en tiempo real.<br>6. El sistema muestra contador de notificaciones no le√≠das. |
| HT-25 | Configurar Repositorio Git | T√©cnica | Como **desarrollador** quiero **configurar repositorio Git** para **gestionar el c√≥digo fuente del proyecto**. | Alta | Infraestructura | 1. El sistema est√° versionado usando Git.<br>2. El sistema est√° alojado en un repositorio remoto (GitHub, GitLab, Bitbucket).<br>3. El sistema utiliza ramas para desarrollo, staging y producci√≥n.<br>4. El sistema implementa pull requests y code reviews.<br>5. El sistema mantiene un historial de commits claro y descriptivo.<br>6. El sistema incluye archivo .gitignore apropiado. |

---

## üìã DEPENDENCIAS ENTRE HISTORIAS

### Dependencias de Historias de Usuario

- **HU-02 (Inicio de Sesi√≥n)** depende de **HT-01 (Configurar Autenticaci√≥n JWT)**
- **HU-06 (Crear Usuario)** depende de **HT-03 (Configurar Encriptaci√≥n de Contrase√±as)**
- **HU-14 (Crear Env√≠o)** depende de **HT-10 (Implementar Generaci√≥n Autom√°tica de Embeddings)** y **HT-20 (Implementar Sistema de Tarifas)**
- **HU-28 (B√∫squeda Sem√°ntica)** depende de **HT-10 (Implementar Generaci√≥n Autom√°tica de Embeddings)** y **HT-11 (Implementar B√∫squeda Vectorial)**
- **HU-31 (Cargar Archivo Excel)** depende de **HT-21 (Implementar Procesamiento de Archivos Excel)**
- **HU-34 (Exportar Env√≠os a Excel)** depende de **HT-23 (Implementar Generaci√≥n de Reportes Excel)**
- **HU-35 (Exportar Env√≠os a PDF)** depende de **HT-22 (Implementar Generaci√≥n de Reportes PDF)**
- **HU-40 (Recibir Notificaciones)** depende de **HT-24 (Implementar Sistema de Notificaciones)**

### Dependencias de Historias T√©cnicas

- **HT-02 (Implementar RBAC)** depende de **HT-01 (Configurar Autenticaci√≥n JWT)**
- **HT-08 (Configurar Integraci√≥n con Supabase)** es requisito previo para **HT-10 (Implementar Generaci√≥n Autom√°tica de Embeddings)**
- **HT-09 (Configurar Integraci√≥n con OpenAI)** es requisito previo para **HT-10 (Implementar Generaci√≥n Autom√°tica de Embeddings)**
- **HT-10 (Implementar Generaci√≥n Autom√°tica de Embeddings)** es requisito previo para **HT-11 (Implementar B√∫squeda Vectorial)**
- **HT-07 (Implementar Arquitectura en Capas)** es requisito previo para todas las historias de implementaci√≥n de funcionalidades

---

## üöÄ FASES FUTURAS (Fuera del MVP)

### Fase 2: Optimizaci√≥n de B√∫squeda
- Mejoras en algoritmos de b√∫squeda sem√°ntica
- Implementaci√≥n de cach√© avanzado
- Optimizaci√≥n de consultas vectoriales
- B√∫squeda h√≠brida (tradicional + sem√°ntica)

### Fase 3: Anal√≠tica Avanzada
- Dashboard con gr√°ficos interactivos
- Reportes personalizados
- An√°lisis predictivo
- Machine Learning para recomendaciones

### Fase 4: Integraciones Externas
- Integraci√≥n con sistemas de transporte
- Integraci√≥n con sistemas de pago
- APIs para terceros
- Webhooks para eventos

### Fase 5: Escalabilidad
- Implementaci√≥n de microservicios
- Load balancing
- CDN para archivos est√°ticos
- Optimizaci√≥n de base de datos para grandes vol√∫menes

---

**Documento generado:** 2024  
**√öltima actualizaci√≥n:** 2024  
**Versi√≥n:** 1.0

