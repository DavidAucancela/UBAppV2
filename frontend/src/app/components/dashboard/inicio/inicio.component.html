<div class="dashboard-container">
  <!-- Pantalla de inicio profesional cuando no hay sesión -->


  <!-- Loading State -->
  <div class="loading-container" *ngIf="loading">
    <div class="spinner">
      <i class="fas fa-spinner fa-spin"></i>
      <span>Cargando estadísticas...</span>
    </div>
  </div>

  <!-- Dashboard Content -->
  <div class="dashboard-content" *ngIf="!loading">
    <div class="stats-grid">

      <!-- Total Envíos Card -->
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-truck"></i>
        </div>
        <div class="stat-content">
          <h3>Total envíos</h3>
          <p class="stat-number">{{ stats.envios?.total_envios || 0 }}</p>
        </div>
      </div>

      <!-- Pending Envíos Card -->
      <div class="stat-card">
        <div class="stat-icon warning">
          <i class="fas fa-clock"></i>
        </div>
        <div class="stat-content">
          <h3>Envíos pendientes</h3>
          <p class="stat-number">{{ stats.envios?.envios_pendientes || 0 }}</p>
        </div>
      </div>

      <!-- Total Products Card -->
      <div class="stat-card" *ngIf="canManageEnvios()">
        <div class="stat-icon">
          <i class="fas fa-box"></i>
        </div>
        <div class="stat-content">
          <h3>Total productos</h3>
          <p class="stat-number">{{ stats.productos?.total_productos || 0 }}</p>
        </div>
      </div>
    </div>

    <!-- Detailed Statistics -->
    <div class="detailed-stats">
      
      <!-- Users by Role (Admin/Gerente) -->
      <div class="stats-section" *ngIf="isAdmin() || isGerente()">
        <div class="section-header">
          <h2>Usuarios por rol</h2>
        </div>
        <div class="stats-cards">
          <div class="mini-stat-card" *ngFor="let stat of stats.usuarios | keyvalue" (click)="goToUsuariosWithRole(stat.key)" style="cursor: pointer;">
            <div class="mini-stat-icon">
              <i class="fas fa-user-tie" *ngIf="stat.key === 'Admin'"></i>
              <i class="fas fa-user-cog" *ngIf="stat.key === 'Gerente'"></i>
              <i class="fas fa-user-edit" *ngIf="stat.key === 'Digitador'"></i>
              <i class="fas fa-user" *ngIf="stat.key === 'Comprador'"></i>
            </div>
            <div class="mini-stat-content">
              <h4>{{ stat.key }}</h4>
              <p>{{ stat.value }}</p>
            </div>
          </div>
        </div>
        <br>
      </div>

      <!-- Envíos by Status -->
      <div class="stats-section">
        <div class="section-header">
          <h2>Envíos por estado</h2>
        </div>
        <div class="stats-cards">
          <div class="mini-stat-card" *ngFor="let stat of stats.envios?.por_estado | keyvalue" (click)="goToEnviosWithEstadoLabel(stat.key)" style="cursor: pointer;">
            <div class="mini-stat-icon" [class]="getStatusClass(stat.key)">
              <i class="fas fa-check-circle" *ngIf="stat.key === 'Entregado'"></i>
              <i class="fas fa-truck" *ngIf="stat.key === 'En tránsito'"></i>
              <i class="fas fa-clock" *ngIf="stat.key === 'Pendiente'"></i>
              <i class="fas fa-times-circle" *ngIf="stat.key === 'Cancelado'"></i>
            </div>
            <div class="mini-stat-content">
              <h4>{{ stat.key }}</h4>
              <p>{{ stat.value }}</p>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

